<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Artigiano V60</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body :class="{'dark-mode': temaEscuro}">
<div id="app" v-cloak>

    <div v-if="!sessaoAtiva" class="modal-overlay">
        <div class="modal-box" style="text-align: center;">
            <i class="fas fa-pizza-slice fa-3x" style="color: var(--ios-red);"></i>
            <h2 style="margin: 20px 0;">Artigiano</h2>
            <input v-model="loginUser" class="btn-main" style="background: #eee; color: #000; margin-bottom: 10px;" placeholder="UsuÃ¡rio">
            <input v-model="loginPass" type="password" class="btn-main" style="background: #eee; color: #000; margin-bottom: 20px;" placeholder="Senha">
            <button @click="fazerLogin" class="btn-main btn-red">ENTRAR</button>
        </div>
    </div>

    <div v-else class="app-layout">
        <header class="app-header">
            <div style="font-weight: 800; font-size: 20px;">Artigiano<span>.</span></div>
            <div style="display: flex; gap: 15px;">
                <button @click="alternarTema" style="background:none; border:none; color:var(--ios-gray);"><i class="fas fa-moon"></i></button>
                <button @click="logout" style="background:none; border:none; color:var(--ios-red);"><i class="fas fa-power-off"></i></button>
            </div>
        </header>

        <main>
            <div v-if="!moduloAtivo" class="dashboard-grid">
                <div class="menu-card card-green" @click="moduloAtivo = 'producao'">
                    <i class="fas fa-calculator"></i>
                    <strong>Massas</strong>
                </div>
                <div class="menu-card card-red" @click="moduloAtivo = 'hortifruti'">
                    <i class="fas fa-carrot"></i>
                    <strong>Hortifruti</strong>
                </div>
                <div class="menu-card card-green" @click="moduloAtivo = 'geral'">
                    <i class="fas fa-boxes-stacked"></i>
                    <strong>Geral</strong>
                </div>
                <div class="menu-card card-red" @click="moduloAtivo = 'bebidas'">
                    <i class="fas fa-wine-bottle"></i>
                    <strong>Bebidas</strong>
                </div>
            </div>

            <div v-else class="inventory-view">
                <div style="padding: 20px; display: flex; align-items: center; justify-content: space-between;">
                    <button @click="moduloAtivo = null" style="background:none; border:none; color:var(--ios-blue); font-size: 16px;">
                        <i class="fas fa-chevron-left"></i> Voltar
                    </button>
                    <h2 style="margin: 0; text-transform: capitalize;">{{ moduloAtivo }}</h2>
                </div>

                <div v-for="item in itensFiltrados" :key="item.id" class="item-card">
                    <div class="item-row">
                        <strong>{{ item.nome }}</strong>
                        <span style="color: var(--ios-gray); font-size: 12px;">Meta: {{ item.meta }}</span>
                    </div>
                    <div class="locations-grid">
                        <div v-for="loc in config.rota" :key="loc" class="input-group">
                            <label>{{ loc }}</label>
                            <input type="number" 
                                   :value="item.contagem ? item.contagem[loc] : ''"
                                   @input="salvarContagem(item.id, loc, $event.target.value)">
                        </div>
                    </div>
                </div>

                <div style="padding: 20px;">
                    <button v-for="d in config.destinos" @click="enviarZap(d)" class="btn-main btn-green" style="margin-bottom: 10px;">
                        <i class="fab fa-whatsapp"></i> Pedir para {{ d.nome }}
                    </button>
                </div>
            </div>
        </main>
    </div>
</div>
<script src="script.js"></script>
</body>
</html>